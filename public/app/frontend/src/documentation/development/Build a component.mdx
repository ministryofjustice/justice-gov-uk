import { Meta, Subtitle } from '@storybook/blocks';

<Meta title="Development/Build a new component" />

# Build a new component

In this guide we'll be building a new component for Justice UK. If you want to build a new layout see [Build a new layout](/docs/development-build-a-new-layout--docs)

## Setup

1. In `./public/app/frontend/src/components` copy the `.template` folder and replace _.template_ in the file names with your components name.
2. Open `./public/app/frontend/index.js` and add an import for your component. This will allow webpack to build your `.js`, `.scss` and `.html.twig` files into the `dist` directory, ready to be used by Wordpress.
3. In `[component-name].stories.js` update the file imports with your component's name and change the title in `default.exports` to _Components/[Component name]_
4. In `index.js` update the file imports to use your component's name. If the component will need to run JavaScript then add `export default function() { // Code goes here }`. You will need to adapt the import in step 2 to import and run the JavaScript, e.g.
```
import component from './components/component;
component();
```

5. In your terminal `cd` into `./public/app/frontend` and run `npm run storybook` to build Storybook. It should open automatically in your browser at `localhost:6006`. Your component will be visible under **Components** in the sidebar.

## Build

1. In `component-name.stories.js` define your templates and any args they might take. For example, a button component with a primary and secondary variant might look like this:

```
export const Primary = Template.bind({});
Primary.args = {
    buttonText: 'Search',
    style: 'primary',
}

export const Secondary = Template.bind({});
Secondary.args = {
    ...Primary.args,
    style: 'secondary'
}
```

2. Build the HTML template in `component-name.html.twig`, including your arguments using Twig syntax and class names in BEM (See [Templating with Twig](https://twig.symfony.com/doc/3.x/templates.html) and [BEM quick start](https://en.bem.info/methodology/quick-start) for more information).
3. Style the component in `component-name.scss`. Ensure you've included `@import '../../../style';` at the top of the file to use global mixins and variables.
4. Add any JavaScript to `index.js` in a default export. See Setup step 4 above for an example.

## Document

All of our components should be well documented. Ideally each component should have:

- At least one example in Storybook for each variant. For example if a button has a primary and secondary variant both should be available in the Storybook sidebar.
- Each component should appear in at least one example page to show how it will look in context.

**JavaScript**: functions should be accompanied by JSDoc comments.

**Sass**:  mixins and functions should be documented with SassDoc.

**Twig**: PHPDoc syntax can be used for Twig files and each component should have an example of how the component can be included, e.g.

```
example:
    {% include '@components/template/template.html.twig' with {
        templateVariable: 'Example variable'
    }%}
```

This makes it easier for backend developers as they can just copy and paste them into Wordpress templates then update the variables.

## Test

Full functional testing will take place once the component is integrated into the backend but we can test responsiveness and accessibility within the Storybook application.

### Browser testing

// TODO: Agree browser testing software, link to Browserstack if we have an account

In Storybook open your component and click on the **Viewport** button in the toolbar at top. Use this to view the component at different screensizes.

### Accessibility testing

// TODO: Agree accessibility testing software, add link

In Storybook open your component and press `‚å• + A` to open the addons panel. Click on the Accessibility tab to view any violations.

## Lint

Once you're happy with your component the final step is to run the linting commands in your terminal.

`npm run lint` will run the linter and show you any issues

`npm run lint-fix` will automatically fix any issues that it can and list any that it couldn't

## Next steps

Once you've built and tested your component in the frontend you can connect it to the backend. See [Connect a component to Wordpress](/docs/development-connect-a-component-to-wordpress--docs) for more information.
